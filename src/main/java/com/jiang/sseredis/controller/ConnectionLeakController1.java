package com.jiang.sseredis.controller;

import com.jiang.sseredis.redis.Publisher;
import com.jiang.sseredis.redis.RedisMsgPubSubListener;
import com.jiang.sseredis.redis.Subscribe;
import com.jiang.sseredis.service.SseObservable1;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.servlet.mvc.method.annotation.SseEmitter;

import java.util.UUID;
import java.util.stream.Stream;


@RestController
@RequestMapping("")
@SuppressWarnings("unused")
public class ConnectionLeakController1{

  private static final Logger LOGGER = LoggerFactory.getLogger(ConnectionLeakController1.class);

  private static final long SSE_TIMEOUT_MS = 30_000L;

  public static final String PREFIX_CHANNEL = "TEST:";

  private final SseObservable1 sseObservable1;

  @Autowired
  private ThreadPoolTaskExecutor taskExecutor;

  @Autowired
  private Subscribe subscribe;

  @Autowired
  Publisher publisher;

  public ConnectionLeakController1() {
    this.sseObservable1 = new SseObservable1(SSE_TIMEOUT_MS);
  }

  @GetMapping("/order")
  public SseEmitter home(@RequestParam(name = "uniCode") String uniCode) {
    SseEmitter emitter = new SseEmitter(SSE_TIMEOUT_MS);
    try {
      LOGGER.info("当前查询：{}",uniCode);
      taskExecutor.execute(() ->{
        String uuid = UUID.randomUUID().toString();
        RedisMsgPubSubListener listener = new RedisMsgPubSubListener(sseObservable1);
        String channel = PREFIX_CHANNEL + uniCode;
        sseObservable1.subscribeSse(emitter,uniCode,listener,channel);
        subscribe.subscribeChannel(channel,listener);
      });
    }catch (Exception e){
      e.printStackTrace();
    }
    return emitter;
  }

  //@Scheduled(fixedRate = 3000L)
  public void herpDerp() {
    String result = sseObservable1.getOrderList("085600170360180505");
    if (null == result){
      return;
    }
    publisher.sendMessage("test-085600170360180505",result);
  }

  @GetMapping("/callback")
  public String callback(@RequestParam(name = "uniCode") String uniCode){
    String result = sseObservable1.getOrderList(uniCode);
    if (null == result){
      return "查不到该订单";
    }
    String channel = PREFIX_CHANNEL + uniCode;
    publisher.sendMessage(channel,result);
    return "success";
  }

  @GetMapping("/callAllBack")
  public String callAllBack(){
    String unicodes = "CNREC18000000000204,uid00060,3013100701189403767700200021620180627143815,3013100701189403767700200015020180627144727,CNREC18000000000200,CNREC18000000000202,3013100701189403767700100023720180628143845,CNREC18000000000203,3013100701189403767700100025320180628145523,3013100701189403767700100025620180628145808,uid00061,CNREC18000000000205,CNREC18000000000206,CNREC18000000000207,9990021581301005103877100000420180629094550,CNREC18000000000212,CNREC18000000000213,CNREC18000000000214,CNREC18000000000215,CNREC18000000000216,CNREC18000000000217,CNCRE18000000000013,CNREC18000000000219,20180702,CNREC18000000000220,CNREC18000000000221,CNREC18000000000222,CNREC18000000000223,CNREC18000000000224,CNREC18000000000225,201807077,2_10_201807026031120129,2_10_201807026031120156,ceshidan1,ceshidan2,ceshidan3,20180702001,1_10_20180702001238_6366614747176972981f62166d,20180702002,20180702004,20180702003,1_10_20180703000007_636662085923421472bb12c7d4,0856006504411804240001,0856006504411804240002,20180702008,20180702007,20180702006,360013016050703,0856006504411804240003,0856006504411804240004,0856006504411804240005,1_10_20180703000032_636662232292416106ac29f48e,0856002300203106190001,0856006504411804240006,0856006504411804240007,20180702005,20180702011,20180702009,20180702010,20180702012,20180702013,20180702015,20180702016,20180702020,20180702019,20180702018,20180702017,66,CNCRE18000000000016,0856006504411804240008,211,81,20180704000,20180704001,298,20180704002,1_36_JSST0000150704_gw8984911ff0df52,20180704003,20180704004,20180704005,20180704006,20180704007,20180704008,CNREC18000000000227,20180704009,0856006504411804240009,0856002300203106190002,uid00062,uid00063,2_10_201807056031120317,2_10_201807056031120319,2_36_801735c0380a4179aeca39d5d0f8d3da,2_36_daa70d0849044b318c4253edb12c8e4d,2_10_201807057005067883,2_10_201807057006033185,1_10_20180705000021_6366638803624301899304c74e,2_10_201807056031120325,2_10_201807057005067890,1_10_20180705000030_636663910263865859dead3986,uid00064,20180605000,1_10_20180705001237_63666400303300712578e15f7a,GY0180520056,LHM0180520056,hjl0180709011,mjs201807051645,1_10_20180705000017_63666384191851043087ce91c7,2015093590,CS20180706001,gjh00064,2_10_201807096031120726,2_10_201807096031120721,gjh00003,uni_code,CNREC18000000000239,CNREC18000000000237,CNREC18000000000241,CNREC18000000000233,CNREC18000000000235,CNREC18000000000236,CNREC18000000000238,CNREC18000000000240,2_10_201807097006033260,gjh00004,1_10_20180710000053_636668198831442184d0e0f35b,2_10_201807096031120724,gjh00005,2_10_201807096031120720,3gjh00001,3gjh00002,3gjh00003,2_10_201807107005068055,34098663858557755776,4gjh00001,4gjh00002,2_10_201807106031120853,2_10_201807106031120830,2_10_201807106031120837,1_10_20180710000058_63666835612332356731f87ea5,1_10_20180710000061_63666836132556595083f43baf,5gjh00001,0856006504411804240010,0856006504411804240011,CNREC18000000000278,CNREC18000000000274,CNREC18000000000282,CNREC18000000000275,CNREC18000000000279,CNREC18000000000276,CNREC18000000000280,CNREC18000000000272,CNREC18000000000277,CNREC18000000000281,2_10_201807106031120836,1_10_20180711000009_6366689968209937252f74a454,CNREC18000000000283,2_10_201807086031120698,2_10_201807087005068023,2_10_201807107005068061,2_10_201807106031120889,2_10_201807106031120893,2_10_201807107006033282,2_10_201807106031120894,2_10_201807107005068062,2_10_201807107005068068,1_10_20180711000014_6366690300527093804d5906d0,1_10_20180711000021_636669032132749593b3d05fdb,1_10_20180711000025_636669034494856082356dddeb,1_10_20180711000035_63666904128343839484e13499,5585043599384028319301,0856006504411804240013,CNREC18000000000308,CNREC18000000000310,CNREC18000000000307,0856006504411804240014,544593150323921792597,CNREC18000000000305,CNREC18000000000303,CNREC18000000000306,CNREC18000000000309,CNREC18000000000304,141461878180942117170,CNREC18000000000300,182397806106365655,CNCRE18000000000027,CNREC18000000000314,CNREC18000000000315,CNREC18000000000316,CNREC18000000000311,CNREC18000000000302,20180712000,20180712001,20180712003,uid00065,13gjh00001,CNREC18000000000320,CNREC18000000000321,97522216252084761264,14gjh00001,15gjh00001,15gjh00002,16gjh00001,0856006504411804240015,0856006504411804240016,0856006504411804240017,17gjh00001,1834421336136840705327,cx000001,733421850196440609180,178721460027743272,18gjh00001,19gjh00001,20gjh00001,21gjh00001,22gjh00001,185288246762267859,0856006504411804240018,23gjh00001,185348054195535194,0856006504411804240019,0802003501461712300408001,191291881731918606,191660475241918807,185454706633518594,0856006504411804240020,058076427606498883893,24gjh00001,576164939484776390236,25gjh00001,25gjh00002,26gjh00001,048500140061180522,cx000003,191757353877490306,186056595799235759,186053065519268559,A_20180516002400690000200517,289202107224984475398,531513689362421515123,cx000005,3174341431166840509100,085600170360180505,cx000006,CNCRE18000000000031,CC4DBF6606CD694AFDE19131DD36874C,E5E1679D483DB1256227F5E67D744C48,C0C6CEF911C5F7208C8F7299AE789C83,4DA49C6E8FD9603BFCF260C3232FAF50,2018052201,036CB74130065098B3E3FFE6FE24DEB5,00100620180601001,00100620180601002,00100620180601003,169971863166062305,E306704F8203F966013DDDAC234BEB2A,00100620180601004,00100620180601005,00100620180601006,00100620180601007,100100620180604001,100100620180604002,2001-9000001640-2018-20180604,100100620180604003,2001-9000001641-2018-20180604,13074027833WWWW,13074027833DDDD,13074027833WWWW,13074027833DDDD,13074027833WWWW,13074027833DDDD,13074027833WWWW,13074027833DDDD,13074027833WWWW,13074027833DDDD,051200090164180531,2001-9000001289-2018-20180604,2001-9000001641-2018-20180605,2001-9000001641-2018,2001-9000001316-2018,155843611659286759,085600710150605001,100108058723106,164452612318062305,100108058414805,085600710150605002,085600710150605003,085600710150605004,2001-9000001267-2018,169783079805478898,156518551024375353,171774593995077329,A04123450019,156618678569246159,156673974724125364,2001-9000001662-2018,173061129526910808,156651377715125364,2001-9000001643-2018,2001-9000001644-2018,2001-9000001645-2018,156713846792125364,2001-9000001653-2018,2001-9000001654-2018,2001-9000001655-2018,2001-9000001656-2018,A04123450020,1_10_201806060100001235_636638977570066689b52483f0,2001-9000001675-2018,2001-9000001678-2018,085600710150607001,1657 0616 6548 5504 93,C7B251DBC05A22C77624E56111BB49B1,2001-9000001258-2018,2001-0091523631-2018,2001-0091523723-2018,2001-0091523862-2018,2001-0091523721-2018,2001-0091524297-2018,2001-0091524163-2018,8902-0091524225-2018,2001-9000001682-2018,2222222212345678999999900001120180608162453,2222222212345678999999900001220180608163816,2222222212345678999999900001520180611090034,2222222212345678999999900001920180611090120,2222222212345678999999900001820180611090111,2222222212345678999999900001620180611090043,2222222212345678999999900001320180611085953,2222222212345678999999900001320180611085953,2222222212345678999999900002120180611090530,2222222212345678999999900002320180611090711,2222222212345678999999900002020180611090423,2222222212345678999999900002420180611090948,2222222212345678999999900002520180611091031,2222222212345678999999900002720180611091110,2222222212345678999999900002220180611090602,2222222212345678999999900002620180611091053,2222222212345678999999900001720180611090058,2001-9000001686-2018,8902-0091529031-2018,2001-0091529313-2018,2002-0091528582-2018,085600150340611001,085600150340611002,085600150340611003,RP20180611BMVGQ11,085600150340611004,2001-9000001687-2018,083300230049180409,2001-9000001692-2018,2001-0091529314-2018,8910-0091529053-2018,2001-0091523732-2018,2002-0091530397-2018,2001-0091531298-2018,2002-0091531397-2018,8902-0091531493-2018,2002-0091531418-2018,2002-0091530425-2018,1_10_201806120100000007_63664417655853842092dc9ba9,2001-0091531369-2018,160175596537121664,1_10_201806120100001211_636644203243255161f91587a5,1_10_201806120100002415_636644208025111105bc65585a,160253386995189561,083300230049180409,lhm666666,2001-9000001648-2018,2001-9000001652-2018,083300230049180409,2001-0091532179-2018,0091532399,1009-0091532382-2018,8902-0091532414-2018,1009-0091532689-2018,2001-0091532678-2018,8902-0091532422-2018,1009-0091532692-2018,2002-0091530431-2018,8902-0091532424-2018,2002-0091532803-2018,2001-0091532677-2018,8910-0091532418-2018,3013100701189403767700200017320180614135225,2001-0091532181-2018,2001-0091533192-2018,666666,2002-0091532712-2018,2001-0091533193-2018,2001-0091532725-2018,2002-0091532728-2018,2002-0091530437-2018,2002-0091533470-2018,2001-0091532726-2018,uid00026,8902-0091533514-2018,8902-0091533510-2018,8902-0091533525-2018,2001-0091533520-2018,8902-0091533528-2018,08560023000180615001,8902-0091533532-2018,8902-0091533537-2018,2001-0091533536-2018,1806155451498020765,2001-0091533534-2018,2001-0091533543-2018,2001-0091533672-2018,2001-0091532777-2018,2001-0091533677-2018,uid00027,CNREC18000000000188,161796549954353055,uid00032,uid00033,uid00034,uid00035,uid00036,uid00037,085600230020310615,2001-0091534227-2018,1806193640102570832,2001-0091533870-2018,2001-0091533871-2018,uid00038,061901,1009-0091533993-2018,2001-0091534485-2018,1009-0091533994-2018,085600230020310619,uid00039,360013016050619,uid00040,uid00041,2_36_ea5f3e13b067415c989fd14839f03f06,uid00042,2_36_629d4ad9aa6b4f33aca8d08a088ab230,2_10_201806206031119250,2_10_201806207005067316,2_10_201806206031119249,uid00043,1806203652305190832,uid00044,1_10_201806200100000034_636650919936638788a9376148,1_10_201806200100000039_63665092689670910253a43c5c,uid00046,uid00047,uid00048,uid00049,uid00050,uid00051,uid00052,uid10052,125320871084162360112,uid00053,uid00054,CNREC18000000000192,CNREC18000000000194,CNREC18000000000189,uid00055,uid00056,uid00057,uid00058,uid00059,CNREC18000000000191,CNCRE18000000000010,CNREC18000000000193,CNREC18000000000190,3013100701189403767702300001520180625141827,181289217235171902,3013100701189403767702300002820180625160653,CNREC18000000000197,085600710150518001,20180517,085600710150518002,085600710150518003,085600710150518004,085600710150518005,085600710150518006,085600150340518101,085600150340518102,161215599818499506,DRF20180514002,WEM0180520001,WEM0180520002,11210-WEM0180520003,08020035014617A001,08020035014617A003,164826883283691885,085600150340521101,085600150340521102,085600150340521103,08020035014617A004,159287921806150362,08020035014617A005,08020035014617A006,085600150340522101,LHM0180520001,163760939084919207,LHM0180520007,LHM0180520006,147933129974375353,164164186729910108,ZXJ201805230001,ZXJ201805230002,ZXJ201805230003,165516550265613388,ZXJ201805230004,ZXJ201805230005,ZXJ201805230006,ZXJ2018052300011,ZXJ2018052300012,9990021581301005103877100000720180523164839,ZXJ201805230007,ZXJ201805230008,ZXJ201805230010,ZXJ2018052300013,ZXJ2018052300014,ZXJ2018052300015,051200620003180505,148577382077799369,164097293201499706,165612924768474898,148582929776407651,148575089652237859,165193430568566892,ZXJ2018052300020,LHM0180520002,ZXJ2018052300024,ZXJ2018052300023,165743377818524893,148928339561138561,164416633802490406,165706166548550493,165705046964609388,085600120214171114,A04123450010,E686FA213E382C31A11918220AC85AC3,F9E2040ACA41AC30EE2862CA3501948B,A04123450011,148924164342188861,164616217869499506,085600700003180523,085600700004180523,A04123450012,085600700018180523,A04123450013,2_36_0d37aca7357948f4a40334eca8039bea,A04123450014,2_36_52cacbdb03f044908da92e390175e62c,085600700029180523,085600700030180523,085600700053180523,085600700054180523,A04123450015,085600700066180523,085600700088180523,A04123450016,LHM0180520008,6649488324843057774120,LHM0180520009,LHM0180520099,647978512717152015847,A04123450017,A04123450018,2_36_77e2b7a4460f4ceaae6d697c0cd030c7,2_36_2262332d7f8641fc951e3864410defc2,2_36_bf56d9bddf7e4a63a9732834a066271a,2_36_d46cc57a7fde42c7876eb71055a6131d,2_36_0b0dd2018a0d46cd8d55445ddef6bf74,2_36_49895a5276b04a00aafc041b58092b2d,2_36_c03844c71ff24754bfd2f8eccf7c0460,2_36_547ce7ace1ea4e4eb6f65df2e1130381,085600060193180523,085600680783180523,085600120097180523,2_36_69c04a4a19fc4205b627a1b04c926ed0,2_36_9a8e9b770f914528b486b9b838d1ed31,2_36_f777c81fba664503be2cd1e8b0dd8a38,167016012123062305,167552912148062305,3767702330131007011894000000120180529164629,167940267544062305,2_36_8534d9d46a8846e98a7c9631210cd4b4,3013100701189403767702300006220180529172809,3767702330131007011894000000220180529174444,3013100701189403767702300000220180529181530,2_36_d62a809954ff41e9a5e354e69f50a295,085600710150530001,3767702330131007011894000000020180530181302,3767702330131007011894000000120180531093650,3767702330131007011894000000220180531095118,2_10_201805316031118222,2_10_201805316031118235,2_10_201805317005066790,0000000000000000000000000000020180531135617,148776462003266759,2_10_201805316031118234,169218913940915106,001497410600300520180325003,001497410600300520180325002,1804190943000000011,001497410600300520180325002,da7e64dc613acc161e1d54d42149180b,de45b52381f6b20e7a3d1ff0f5258292,Z20180411005,4cc9b88d8f6111ee57dddfa7baaeb9b4,63692783d04234174e05733d63f37e5b,d77ecfd66b7dbda3f6e286b3f9a3c3f1,963258741,081900710150419001,146592804511125364,00958566827000256911652000057,9632587411,96325874112,963258741121,8270002569116520095856600006420180419175005,9632587411212,8270002569116520095856600006620180419175730,40333a333764e9f748cdeed629becc7a,9632587411212,96325874112123,081900710150419002,081900710150419003,963258741121231,a7f312cbe2bd4ee10532a1a9876c2057,c57daec3da0a0a8263a6b5c00c7c55b8,f94e76445aa72ada3294689e48dd8f37,080200350146171283,b31b77f78460fb7a1cbdd3b99a64fee3,589eb027ff8e99d22bf5acb16dd959bf,86da83161d2c7ae3e7767b2d9864a2c3,8270002569116520095856600000620180420140855,Z20180411007,Z20180411008,Z20180411003,Z20180411004,8270002569116520095856600005520180420161205,8270002569116520095856600006120180420162132,8270002569116520095856600011020180420161000,f0e9ae61d1d0864ec9cbd4d14898f864,8270002569116520095856600007920180420171421,fc3d377c542e0ab35f38ab8bd93be4d0,8270002569116520095856600008420180420180642,7be25142e6db0890aff9d730b2282d04,7be25142e6db0890aff9d730b2282d04,84a6c64621e268bee54f19a8c15ffc42,84a6c64621e268bee54f19a8c15ffc42,31525284a35b9b4413193706ebd6740f,ac444dbf89ea5080732ec36f82fb7dd0,ac444dbf89ea5080732ec36f82fb7dd0,04380cf1ed71f75a1eeb3c0824e3a945,080200350146171290,080200350146171293,080200350146171291,080200350146171292,8270002569116520095856600021720180423143120,de565c92ad4b71c9d569b883208efbc2,00100620180423002,00100620180423003,8270002569116520095856600010720180423171242,a2042c7bccbc44668693feb558210b07,2_36_ed538665416842489feb4e4da0320933,8270002569116520095856600010020180425103502,8270002569116520095856600010320180425112822,8270002569116520095856600011120180425134210,Z20180411006,8270002569116520095856600011720180425151649,085600710150425001,8270002569116520095856600012020180425160644,F4426F2AEB0A990D3369EAE0E737E498,5947982E45DD871BD70F401320DBCCDC,572FF5269052B6EE25314B0D3560270D,8270002569116520095856600000420180425172203,2_36_be0a71e9e07a43a1b9d7585b853264b1,20180426,085600710150426001,085600150340426101,085600620180426002,2_36_53935b62318041889ccbb334fff728e9,1_36_JSST0000104630_gh9046333db355de,1_36_JSST0000104624_gw822057492bd02b,Z2018042600002,Z2018042600003,2_36_17826671307847fdacb59ed4b53c2558,Z2018042600005,1FD8CECFA9057E84C5B99075D7B4D4AF,6609D3AFF2F9EEFB74023748DE761EC1,D2CE77CC4309C5DF6D7D0ACEBEEA3528,8A659446364D8505F5CEBA7BBCB3F144,085600710150428001,6F301B7E45F0D48F88A83E69587A606E,2_36_81900019bd604f4da2184b2eb60a5905,2_36_2acf692420344a3db00455bf18ffb762,085600710150502001,80313413BBBE4C06CE681B87D706EF40,085600710150502002,9A3A1584EA20BB8E4062F9DB4D6E9CC2,C595F954A1A98014DFD449E6D94D9857,139590556214169953,D6673C78348BD879C6E41CF157BD982C,6D08A08CC426A6FCF54C99C8BEFE734D,8270002569116520095856600001320180508152940,0AEFB6320CDEDD97D6E253675AB61A9E,8270002569116520095856600000820180508161042,8270002569116520095856600006020180508165837,2_36_cd60b011da0c45f4b65a77e9da34a77a,2_36_fa5476791557429a8d12632d97701967,8270002569116520095856600000820180509144746,8270002569116520095856600001920180510110904,8270002569116520095856600006520180510135743,9990021581301001631000100000320180510134713,88312580763870B3CA140E95D2C3ACC0,9990021581301001631000100000520180510141103,9990021581301001631000100000820180510141335,0157000051165241-201805,ZXJ0157000051165241-201805,snh20180511001-201805,051101,4ACE5290D073D6A99ACED6772D3BA104,9990021581301001631000100000120180514101110,5D010D124A250D282F0641D418D0C1E2,DRF20180514001,9990021581301001631000100000520180515100942,9990021581301001631000100000720180515102316,0157000011154710-201805,9990021581301001631000100000120180515112952,0157000011155469-201805,9990021581301001631000100000420180515141405,9990021581301001631000100000920180515143624,9990021581301001631000100000120180515144431,146094985065365655,112233445566,161999552799687886,160249680500499206,161939634191694885,3013100701189403767702300000220180517141014,085600710150517001,3013100701189403767702300000620180517144320,3013100701189403767702300000820180517145642,162659288748487395,872867907928939753664,460164978632376464670,68406437828398567478,13074027833WWWW,13074027833DDDD,0802003501461712381,080200350146171238,085600130162180408,0802003501461712300408009,080200350146171250,0802003501461712360408001001,9004871739019540351559,c6c1cb2ee28a11282da4f2cf0efd6ae5,0802003501461712360408001003,sZ20180411_40,sZ20180411001_40,sZ20180411001_41,sZ20180411001_42,sZ20180411001_43,sZ20180411001_44,sZ20180411001_45,sZ20180411001_46,sZ20180411001_47,sZ20180411001_48,085600620180403001,085600620180402001,sZ20180411001_50,sZ20180411001_51,sZ20180411001_52,11210-sZ20180411001_53,sZ20180411001_54,sZ20180411001_55,sZ20180411001_56,sZ20180411001_57,sZ20180411001_58,sZ20180411001_59,sZ20180411001_60,sZ20180411001_61,sZ20180411001_62,sZ20180411001_63,sZ20180411001_64,~!@#$%^&*()_~！@#￥%……&*（）——+,sZ20180411001_70,sZ20180411001_71,sZ20180411001_72,sZ20180411001_73,sZ20180411001_74,sZ20180411001_75,sZ20180411001_76,sZ20180411001_77,sZ20180411001_78,sZ20180411001_79,sZ20180411001_80,20180101-20180102-20180103-20180101-2018010-2018010-201801000000,sZ20180411001_82-sZ20180411001_82-sZ20180411001_82-2222222222222,sZ20180411001_83-sZ20180411001_83-sZ2018,zZ20180411001_001,zZ20180411001_001,CXJ20180426-250,CXJ20180426-251,CXJ20180426-255,201804260001001,201804260001002,201804260001007,201804260001008,201804260001008,20180426000100900100,201804260001009001002,201804260001009001003,201804260001009001004,20180503001,20180503002,20180503003,20180503004,100020180503001,100020180503002,100020180503003,500-2018050300401,500-2018050300402,HY20180521001,HY20180521002,YP20180521001,YP20180521002,LWM20180521001,LWM20180521002,CML20180521001,CML20180521002,LHM20180525001,30180101-20180102-20180103-20180101-2018010-2018010-201801000000,3Z20180411001_82-sZ20180411001_82-sZ20180411001_82-2222222222222,3Z20180411001_83-sZ20180411001_83-sZ2018,ZXJ20180525004,ZXJ20180525005,ZXJ20180525006,ZXJ20180525007,ZXJ20180525008,ZXJ20180525009,ZXJ20180525010,ZXJ20180525011,ZXJ20180525012,ZXJ20180525013,CML201806040001,CML201806040002,CML201806040003,CML201806040004,ZXJ20180528001,ZXJ20180528002,BW20180606001,BW20180606002,081900710150416024,20180706000,20180101527,402817950917239901423,0802003501461712360408001009,Z20180411002,A_20180411000100080000032001,A_20180411000100080000032002,1_36_201804121814,2_36_e3a586cfca0e40158c05cc4f63d4e26c,Z20180411011,Z20180411010,080200350146171255,2_36_20180413135250,2_36_20180413130620,080200350146171260,Z20180411009,080200350146171259,085600040190413001,085600040190414001,085600040190416001,085600040190416002,085600040190416003,085600040190416004,085600040190416005,085600710150416010,085600710150416011,081900710150416012,1593571,081900710150416013,081900710150416014,081900710150416015,081900710150416016,081900710150416017,081900710150416018,081900710150416019,004542460600300520180325001,004542460600300520180325003,081900710150416020,2_36_dc2aec8e252b42609f97ed59752b8f57,2_36_802bb426724a4435a143105cba50276d,2_36_019af6a9107744b0b7342bd3c8e2edf1,080200350146171266,1_36_JSST0000104553_gw3124795b52c058,080200350146171267,1_36_JSST0000104559_gw025970d72a69e0,1_36_JSST0000104616_w1247396125de70,004524100073800720180325001,004524100073800720180325002,080200350146171268,085600710150417001,2_36_8c3b8bf7e7f14afabbe5b3c6d0f14926,1_36_JSST0000104755_gw8039260d37475d,081900710150416021,1_36_JSST0000104820_w0265449e039844,1_36_JSST0000104829_w52845736bdaa24,13074027833WWWW,13074027833DDDD,004524100073800820180325001,004524100073800820180325002,005742460600300520180325001,005742460600300520180325003,2_36_e30c197bba754ce1b00514445e7b968f,2_36_4fa8b35643d54d788949749fe85ec62c,2_36_8ae7912ba54e47d387d2a975cb40765f,007242460600300520180325,2_36_2a06345a3ede47e8a1f0ddeac021469f,2_36_0ae06a68c70842a19ed439d89236a811,1_36_JSST0000104864_gw2483851a505240,1_36_JSST0000104866_gw5024489e585541,1_36_JSST0000104858_gw885366f60054b3,1_36_JSST0000104875_w3326533398ab66,147258,083300230049180409,081900710150416022,080200350146171280,081900710150416023,114477,225588,13074027833WWWW,13074027833DDDD,2017606179,2017614068,081900710150418001,13074027833WWWW,13074027833DDDD,2017606187,081900710150418002,13074027833WWWW,13074027833DDDD,13074027833WWWW,13074027833DDDD,225588996633,22558899663322,1230,2017606178001,2017606178002,1230123,00001,225588996633223,20180418207950400000111,005024100600300520180325,004524100073800920180325001,004524100073800920180325002,2018041820795040000011122,0003,000301,20180418909098400000,20180418302200500000,201804171234571,8270002569116520095856600002220180418170651,201804171234571,2018041712345712,2018041712345713,201804181719002,080200350146171288,00030102,1804161820440000062,319401804040856030000006,000301021111,8270002569116520095856600000920180419110240,0003021,00030211,396401804190943000000015,005724100600300320180325,001497410600300520180325001";
    String[] st = unicodes.split(",");
    Stream.of(st).forEach(unicode -> {
      taskExecutor.execute(() -> {
        String result = sseObservable1.getOrderList(unicode);
        if (null == result){
          return;
        }
        String channel = PREFIX_CHANNEL + unicode;
        publisher.sendMessage(channel,result);
      });
    });
    return "success";
  }

}
